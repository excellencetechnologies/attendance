(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1087:function(e,t,a){"use strict";a.r(t);var n=a(25),i=a(26),o=a(29),s=a(27),r=a(28),l=a(12),c=a(0),d=a.n(c),u=a(36),m=a(1075),p=a(1),f=a.n(p),h=a(9),b=a.n(h),g=a(43),v=a(122),E=a(253),y=a(37),j=a(595),O=a(254),R=a.n(O),_=a(680),N=a.n(_),k=a(629),C=a.n(k),I=a(123),x=a.n(I),w=a(101),D=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).state={open:!1,baseRoleId:"",name:"",description:"",error:{baseRoleId:"",name:"",description:""}},a.handleOpen=a.handleOpen.bind(Object(l.a)(Object(l.a)(a))),a.handleClose=a.handleClose.bind(Object(l.a)(Object(l.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(l.a)(Object(l.a)(a))),a}return Object(r.a)(t,e),Object(i.a)(t,[{key:"handleOpen",value:function(){this.setState({open:!0,baseRoleId:"",name:"",description:""})}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"handleSubmit",value:function(){var e=this.state,t=e.baseRoleId,a=e.name,n=e.description,i={baseRoleId:"",name:"",description:""},o=!0;b.a.isEmpty(a)&&(o=!1,i.name="This field is required."),b.a.isEmpty(n)&&(o=!1,i.description="This field is required."),this.setState({error:i}),o&&(this.props.callAddNewRole({baseRoleId:t,name:a,description:n}),this.handleClose())}},{key:"render",value:function(){var e=this,t=b.a.map(this.props.displayData.roles,function(e,t){return d.a.createElement("div",{id:"".concat(e.name,"_list"),key:t},d.a.createElement(C.a,{key:t,value:e.id,primaryText:e.name}))});return d.a.createElement("div",{className:"col-sm-12 p-y",id:"role_button"},d.a.createElement(w.a,{className:"btn-fw info",id:"add_role",onClick:this.handleOpen,label:"Add New Role"}),d.a.createElement(x.a,{id:"add_role_dialog",title:"Add Role",modal:!1,open:this.state.open,onRequestClose:this.handleClose,contentClassName:"dialog-add-role",autoScrollBodyContent:!0},d.a.createElement("br",null),d.a.createElement(N.a,{fullWidth:!0,id:"role_selector",value:this.state.baseRoleId,onChange:function(t,a,n){e.setState({baseRoleId:n})}},d.a.createElement(C.a,{value:"",primaryText:" Select Base Role "}),d.a.createElement("div",{id:"role_list"},t)),d.a.createElement(R.a,{id:"role_name",floatingLabelText:"Name",floatingLabelFixed:!0,fullWidth:!0,onChange:function(t){return e.setState({name:t.target.value})},value:this.state.name,errorText:this.state.error.name}),d.a.createElement(R.a,{id:"role_desc",floatingLabelText:"Description",floatingLabelFixed:!0,fullWidth:!0,onChange:function(t){return e.setState({description:t.target.value})},value:this.state.description,errorText:this.state.error.description}),d.a.createElement(w.c,{className:"col-md-12 m-y-sm indigo",id:"role_submit_button",onClick:function(){return e.handleSubmit()},label:"Submit New Role"})))}}]),t}(d.a.Component);D.PropTypes={displayData:f.a.shape({roles:f.a.Array}).isRequired,callAddNewRole:f.a.func.isRequired};var q=a(1074),S=function(e){var t=e.displayData,a=e.handleChange,n=e.handleChangeNotification,i=e.handleDelete,o=t.roles,s=b.a.map(o,function(e,t){var o=e.id,s=b.a.map(e.role_pages,function(e,t){var n=e.id,i=b.a.map(e.actions_list,function(e,t){var n=e.id;return d.a.createElement("li",{key:t},d.a.createElement("input",{type:"checkbox",id:"check_"+e.name,value:e.name,checked:e.is_assigned,onChange:function(e){a(e,n,o)},key:n})," ",e.name)});return d.a.createElement("li",{key:t},d.a.createElement("input",{type:"checkbox",id:"check_"+e.name,value:e.name,checked:e.is_assigned,onChange:function(e){a(e,n,o)},key:n})," ",e.name,d.a.createElement("ul",{className:"m-b-xs m-l-md"},i))}),r=b.a.map(e.role_notifications,function(e,t){var a=e.id;return d.a.createElement("div",{key:t},d.a.createElement("input",{type:"checkbox",value:e.name,checked:e.is_assigned,onChange:function(){n(a,o)},key:a})," ",e.name,d.a.createElement("br",null))}),l="coll"+o;return d.a.createElement("div",{className:"panel panel-default",id:"".concat(e.name,"_body"),style:{border:0},key:t},d.a.createElement("div",{className:"panel-heading p-b-lg"},d.a.createElement("div",{className:"panel-title p-b-md"},d.a.createElement("span",{className:"col-xs-8 col-sm-9"},d.a.createElement(q.a,{"data-toggle":"collapse","data-parent":"#accordion",to:"#".concat(l)},d.a.createElement("h4",{className:"m-b-xs text-lg col-xs-10",id:"".concat(e.name,"_span")},e.name),d.a.createElement("span",{className:"col-xs-12 text-sm"},e.description))),d.a.createElement(q.a,{to:"/manage_roles",id:"".concat(e.name,"_delete"),className:"col-xs-4 col-sm-3 m-t-sm p-t-sm text-sm text-danger",onClick:function(){Object(g.a)("Are you sure ?","Do you want to Delete the Role ?","warning").then(function(e){e&&i(o)})}},d.a.createElement("i",null,"Delete Role")))),d.a.createElement("div",{id:l,className:"table-responsive panel-collapse collapse"},d.a.createElement("div",{className:"navside panel-body p-a-xs"},d.a.createElement("table",{className:"table table-condensed"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Pages - Actions"),d.a.createElement("th",null," Notification "))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("ul",null,s)),d.a.createElement("td",null,r)))))))});return d.a.createElement("div",{className:"row box p-t"},d.a.createElement("div",{className:"col-xs-12 panel-group",id:"accordion"},s))},P=S;S.PropTypes={displayData:f.a.shape({roles:f.a.object.isRequired}).isRequired,handleChange:f.a.func.isRequired,handleChangeNotification:f.a.func.isRequired,handleDelete:f.a.func.isRequired};var A=a(105),T=a.n(A),L=function(e){var t=e.users,a=e.onChange,n="";if(void 0!==t.users_list){var i=t.users_list.data,o=t.roles;n=b.a.map(i,function(e,t){var n="",i="",s=e.user_Id,r=e.role_name,l=d.a.createElement("span",{className:"text-success text-sm",id:"".concat(t,"_span")},d.a.createElement("b",null,"Role")," : ",r," "," ",d.a.createElement("span",{onClick:function(){a(s,"0")},className:"glyphicon glyphicon-remove text-danger",title:"Remove Role"}));null!==r&&0!==r||(l=d.a.createElement("span",{className:"text-danger text-sm"},d.a.createElement("b",null,"Role")," : -- ")),b.a.isEmpty(e.slack_profile)?(i=null!=e.name?e.name.charAt(0):"",n=d.a.createElement(T.a,null,i)):(i=e.slack_profile.image_72,n=d.a.createElement("img",{src:i}));var c=b.a.map(o,function(e,t){return d.a.createElement("option",{key:t,id:"".concat(e.name,"_val"),value:e.id},e.name)}),u=d.a.createElement("select",{key:s,name:s,id:"".concat(t,"_change"),onChange:function(e){a(s,e.target.value)},className:"form-control text-muted text-ellipsis"},d.a.createElement("option",{value:"-1"}," CHANGE ROLE "),c);return d.a.createElement("div",{className:"b-x p-a-sm pointer",id:"".concat(t,"_list"),key:t},d.a.createElement("div",{className:"list-left"},d.a.createElement("span",{className:"w-40 avatar"},n)),d.a.createElement("div",{className:"list-body"},d.a.createElement("span",null,e.name),d.a.createElement("small",{className:"text-muted text-ellipsis"},e.jobtitle),l,u))})}return d.a.createElement("div",{className:"box responsive-p-x-sm p-y clear fixed-height",id:"user_list"},n)},U=L;L.PropTypes={users:f.a.shape({users_list:f.a.Object}).isRequired,onChange:f.a.func.isRequired};var J=a(5),W=a(1115),F=a(11),B=a(31),G=a(2);function H(e){return Object(W.a)(G.s)(e)}function M(e){return function(t,a){var n=e.baseRoleId,i="",o="";return"undefined"===typeof e.name||""==e.name?Promise.reject("Name is empty"):(i=e.name,"undefined"===typeof e.description||""==e.description?Promise.reject("Description is empty"):(o=e.description,new Promise(function(e,a){t(Object(B.b)()),function(e,t,a){return Object(F.b)("POST","",{action:"add_roles",base_role_id:e,name:t,description:a})}(n,i,o).then(function(e){var a;t(Object(B.a)()),0==e.error?(t((a=e.message,Object(W.a)(G.Gb)(a))),t(z())):t(H(e.message))},function(e){t(Object(B.a)()),t(H("error occurs!!!")),a("error occurs!!!")})})))}}function z(){return function(e,t){return new Promise(function(t,a){e(Object(B.b)()),Object(F.b)("POST","",{action:"list_all_roles"}).then(function(t){var a;e(Object(B.a)()),0==t.error?e((a=t.data,Object(W.a)(G.ic)(a))):e(function(e){return Object(W.a)(G.g)(e)}([]))},function(t){var a;e(Object(B.a)()),e((a=[],Object(W.a)(G.N)(a)))})})}}function X(e){return Object(W.a)(G.X)(e)}function K(e){return function(t,a){var n="",i="",o="",s="";return"undefined"!==typeof e.notificationId&&(s=e.notificationId),"undefined"!==typeof e.rolesId&&(n=e.rolesId),"undefined"!==typeof e.actionId&&(i=e.actionId),"undefined"!==typeof e.pageId&&(o=e.pageId),""===n.trim()?Promise.reject("User id is empty"):new Promise(function(){t(Object(B.b)()),function(e,t,a,n){return Object(F.b)("POST","",{action:"update_role",role_id:t,page_id:n,action_id:a,notification_id:e})}(s,n,i,o).then(function(e){var a;t(Object(B.a)()),0==e.error?(t(z()),t((a=e.message,Object(W.a)(G.tc)(a)))):t(X(e.message))},function(e){t(Object(B.a)()),t(X("error occurs!!!"))})})}}function Q(e){return Object(W.a)(G.ab)(e)}function V(e){return function(t,a){var n="",i="";return"undefined"!==typeof e.roleId&&(n=e.roleId),"undefined"!==typeof e.userId&&(i=e.userId),""===n.trim()?null:""===i.trim()?Promise.reject("User id is empty"):new Promise(function(){t(Object(B.b)()),function(e,t){return Object(F.b)("POST","",{action:"assign_user_role",user_id:e,role_id:t})}(i,n).then(function(e){var a;t(Object(B.a)()),0==e.error?t((a=e.message,Object(W.a)(G.wc)(a))):t(Q(e.message))},function(e){t(Object(B.a)()),t(Q("error occurs!!!"))})})}}function Y(e){return function(t,a){return"undefined"===typeof e||""==e?Promise.reject("Delete Id is empty"):new Promise(function(a,n){t(Object(B.b)()),function(e){return Object(F.b)("POST","",{action:"delete_role",role_id:e})}(e).then(function(e){t(Object(B.a)()),0==e.error?(a(e.message),t(z())):n(e.message)},function(e){t(Object(B.a)()),n("error occurs!!!")})})}}var Z=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).props.onIsAlreadyLogin(),a.state={status_message:"",rolesData:[],updateRole:{rolesId:"",actionId:"",pageId:"",notificationId:""}},a.callAddNewRole=a.callAddNewRole.bind(Object(l.a)(Object(l.a)(a))),a.handleChangeNotification=a.handleChangeNotification.bind(Object(l.a)(Object(l.a)(a))),a.onUserClick=a.onUserClick.bind(Object(l.a)(Object(l.a)(a))),a.handleChange=a.handleChange.bind(Object(l.a)(Object(l.a)(a))),a}return Object(r.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.onRolesList()}},{key:"componentWillReceiveProps",value:function(e){var t=e.loggedUser,a=e.location,n=e.history,i=e.manageRoles.rolesData,o=Object(y.e)(a.pathname,t);o.status&&n.push(o.redirectTo),i!==this.state.rolesData&&this.setState({rolesData:i})}},{key:"callAddNewRole",value:function(e){this.props.onAddNewRole(e)}},{key:"handleChangeNotification",value:function(e,t){var a=this.state.updateRole;a.rolesId=t,a.notificationId=e,this.props.onUpdateRole(a)}},{key:"onUserClick",value:function(e,t){var a={userId:e,roleId:t};"-1"!==t&&(this.props.onUpdateUserRole(a),this.props.onRolesList())}},{key:"handleDelete",value:function(e){this.props.onDelete(e).then(function(e){Object(g.b)("Success!",e,"success")},function(e){Object(g.b)("Error!",e,"error")})}},{key:"handleChange",value:function(e,t,a){var n=this.state.rolesData,i=b.a.clone(this.state.updateRole);b.a.map(n.roles,function(n,o){n.id===a&&b.a.map(n.role_pages,function(a,n){a.id===t?(a.is_assigned=e.target.checked,i.pageId=t,b.a.map(a.actions_list,function(t,a){t.is_assigned=e.target.checked})):b.a.map(a.actions_list,function(a,n){a.id===t&&(a.is_assigned=e.target.checked,i.actionId=t)})})}),i.rolesId=a,this.setState({rolesData:n}),this.props.onUpdateRole(i)}},{key:"render",value:function(){var e=this;return d.a.createElement("div",null,d.a.createElement(v.a,this.props),d.a.createElement(j.a,{message:this.props.manageRoles.status_message}),d.a.createElement("div",{id:"content",className:"app-content box-shadow-z0",role:"main"},d.a.createElement(E.a,{pageTitle:"Manage Roles",showLoading:this.props.frontend.show_loading}),d.a.createElement("div",{className:"app-body",id:"view"},d.a.createElement("div",{className:"padding"},d.a.createElement("div",{className:"row"},d.a.createElement(D,{callAddNewRole:this.callAddNewRole,displayData:this.state.rolesData})),d.a.createElement("div",{className:"row",id:"role_page"},d.a.createElement("div",{className:"col-sm-8"},d.a.createElement(P,{displayData:this.state.rolesData,handleClick:function(t){return e.click(t)},handleChange:this.handleChange,handleChangeNotification:function(t,a){return e.handleChangeNotification(t,a)},handleDelete:function(t){e.handleDelete(t),e.setState({deleteId:t})}})),d.a.createElement("div",{className:"col-sm-4"},d.a.createElement(U,{users:this.state.rolesData,onChange:function(t,a){e.onUserClick(t,a)}})))))))}}]),t}(d.a.Component);var $=Object(u.b)(function(e){return{frontend:e.frontend.toJS(),loggedUser:e.logged_user.userLogin,usersList:e.usersList.toJS(),manageRoles:e.manageRoles.toJS()}},function(e){return{onIsAlreadyLogin:function(){return e(J.isAlreadyLogin())},onAddNewRole:function(t){return e(M(t))},onRolesList:function(){return e(z())},onUpdateRole:function(t){return e(K(t))},onUpdateUserRole:function(t){return e(V(t))},onDelete:function(t){return e(Y(t))}}})(Z),ee=Object(m.a)($);t.default=ee;Z.PropTypes={onIsAlreadyLogin:f.a.func.isRequired,onFetchUserPolicyDocument:f.a.func.isRequired,onRolesList:f.a.func.isRequired,route:f.a.shape({path:f.a.string.isRequired}).isRequired,loggedUser:f.a.shape({isLoggedIn:f.a.bool.isRequired,data:f.a.object.isRequired}).isRequired,policy_documents:f.a.shape({policyDocuments:f.a.object}).isRequired,usersList:f.a.object.isRequired,router:f.a.object.isRequired}},595:function(e,t,a){"use strict";var n=a(0),i=a.n(n),o=a(1),s=a.n(o),r=a(9),l=a.n(r),c=a(593),d=a.n(c),u=function(e){var t=e.message,a=(e.handleRequestClose,!1),n="";return l.a.isEmpty(t)||(a=!0,n=t),i.a.createElement(d.a,{open:a,message:n,autoHideDuration:4e3})};u.PropTypes={message:s.a.string.isRequired},t.a=u}}]);
//# sourceMappingURL=32.c2ee76ce.chunk.js.map