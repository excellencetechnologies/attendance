(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{1101:function(e,a,t){"use strict";t.r(a);var r=t(25),l=t(26),n=t(29),o=t(27),i=t(28),c=t(0),s=t.n(c),d=t(36),b=t(1073),u=t(123),m=t(37),p=t(254),h=t(5),v=t(9),f=t(1112),g=t(23),E=t(11),V=t(2),y=t(31);t(173);function C(e){return Object(f.a)(V.Mb)(e)}function T(e){return Object(f.a)(V.y)(e)}function O(e,a){return function(t,r){return new Promise(function(r,l){t(Object(y.b)()),""==e?function(e,a){return Object(E.b)("POST","",{action:"create_template_variable",name:a.varCode,value:a.varValue,variable_type:a.varType})}(0,a).then(function(e){t(Object(y.a)()),0==e.error?(t(C(e.data)),t(x()),r(e.data)):t(T(e.error[0]))},function(e){t(Object(y.a)()),t(T("error occurs"))}):function(e,a){return Object(E.b)("POST","",{action:"update_template_variable",id:e,name:a.varCode,value:a.varValue,variable_type:a.varType})}(e,a).then(function(e){t(Object(y.a)()),0==e.error?(t(C(e.data)),t(x()),r(e.data)):t(T(e.error[0]))},function(e){t(Object(y.a)()),t(T("error occurs"))})})}}function w(e){return Object(f.a)(V.Dc)(e)}function x(){return function(e,a){return new Promise(function(a,t){e(Object(y.b)()),Object(E.b)("POST","",{action:"get_template_variable"}).then(function(t){if(e(Object(y.a)()),"undefined"!==typeof t&&t.length>0){var r=t;e(w(r)),a(r)}else e(w([]))},function(a){e(Object(y.a)()),e(w([]))})})}}function j(e){return function(a,t){return new Promise(function(t,r){a(Object(y.b)()),function(e){return Object(E.b)("POST","",{action:"delete_template_variable",id:e})}(e).then(function(e){a(Object(y.a)()),e.error,a(x()),t(e.data.message)},function(e){a(Object(y.a)()),r("error occurs!!")})})}}var S,R=t(12),A=t(7),_=(t(43),t(57),t(255)),N=t.n(_),k=t(125),L=t.n(k),B=t(127),I=t.n(B),P=t(674),W=t(124),D=t.n(W),F=t(79),H=t.n(F),U=t(256),z=t.n(U),M=t(629),J=t.n(M),q=t(676),G=t(1056),K=t.n(G),$={block:{maxWidth:250},lable:{fontWeight:"normal",fontSize:15},container:{position:"relative",textAlign:"center",paddingTop:"200px"},formInput:{marginLeft:"5%",marginRight:"5%",width:"90%",paddingTop:"10px",color:"gray"},radioButton:(S={marginBottom:16,width:"50%",float:"left"},Object(A.a)(S,"marginBottom","0px"),Object(A.a)(S,"marginTop","16px"),S),radioLabel:{fontWeight:300}},Q=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(n.a)(this,Object(o.a)(a).call(this,e))).props.onIsAlreadyLogin(),t.state={paper:"show",openDialog:!1,dialogTitle:"",variableType:"user",variableCode:"",floatingLabelCode:"",hintCode:"",varCodeError:"",variableValue:K.a.createEmptyValue(),variableValue_forTextArea:"",floatingLabelValue:"",hintValue:"",varValError:"",varId:"",editor:"show",textArea:"hidden"},t.openCreateVariable=t.openCreateVariable.bind(Object(R.a)(Object(R.a)(t))),t.saveVariable=t.saveVariable.bind(Object(R.a)(Object(R.a)(t))),t.deleteVariable=t.deleteVariable.bind(Object(R.a)(Object(R.a)(t))),t.editVariable=t.editVariable.bind(Object(R.a)(Object(R.a)(t))),t.onChange=t.onChange.bind(Object(R.a)(Object(R.a)(t))),t.changeEditor=t.changeEditor.bind(Object(R.a)(Object(R.a)(t))),t}return Object(i.a)(a,e),Object(l.a)(a,[{key:"componentWillReceiveProps",value:function(e){window.scrollTo(0,0),e.loggedUser.isLoggedIn?e.loggedUser.data.role===g.a.ADMIN||e.loggedUser.data.role===g.a.HR||this.props.history.push("/home"):this.props.history.push("/logout")}},{key:"onChange",value:function(e){this.setState({variableValue:e})}},{key:"changeEditor",value:function(e){"textArea"===e.target.value?this.setState({textArea:"show",editor:"hidden"}):this.setState({textArea:"hidden",editor:"show"})}},{key:"openCreateVariable",value:function(){this.setState({variableCode:"",varCodeError:"",variableValue:K.a.createEmptyValue(),variableValue_forTextArea:"",varValError:"",openDialog:!0,varId:"",dialogTitle:"Create Variable",floatingLabelCode:"Variable Code",hintCode:"Enter Variable Code",floatingLabelValue:"Variable Value",hintValue:"Enter Varaible Value"})}},{key:"gotoVariablePage",value:function(){this.setState({variableCode:"",varCodeError:"",variableValue:K.a.createEmptyValue(),varValError:"",openDialog:!1,dialogTitle:"",hintValue:"",textArea:"hidden",editor:"show"})}},{key:"saveVariable",value:function(){var e=this,a=this.state.variableCode.replace(/^\s+|\s+$/gm,"").trim(),t="";t="show"===this.state.editor?this.state.variableValue.toString("html"):this.state.variableValue_forTextArea;var r=this.state.variableType.trim(),l=this.state.varId,n=!0,o=document.createElement("span");o.innerHTML=a;var i=o.textContent||o.innerText;if(i=i.trim(),""!==a?this.setState({varCodeError:""}):(n=!1,this.setState({varCodeError:"Required"})),"user"===r?""!==t?this.setState({varValError:""}):(n=!1,this.setState({varValError:"Required"})):t="",n){a=a.toLowerCase(),"#"!==v.trim(a)[0]&&(a="#"+a);var c={varCode:a,varValue:t,varType:r};this.props.onSaveVariable(l,c).then(function(a){e.setState({variableCode:"",variableValue:K.a.createEmptyValue(),variableValue_forTextArea:"",varId:""}),e.gotoVariablePage()}).catch(function(a){e.setState({variableCode:"",variableValue:K.a.createEmptyValue(),variableValue_forTextArea:""})})}}},{key:"editVariable",value:function(e){this.setState(Object(A.a)({variableCode:e.name,varCodeError:"",variableValue:K.a.createValueFromString(e.value,"html"),variableValue_forTextArea:e.value,varValError:"",openDialog:!0,varId:e.id,dialogTitle:"Edit Variable",floatingLabelCode:"Variable Code",hintCode:"",floatingLabelValue:"Variable Value"},"hintCode",""))}},{key:"deleteVariable",value:function(e){this.props.onDeleteVariable(e.id).then(function(){}).catch(function(e){})}},{key:"render",value:function(){var e=this,a=[s.a.createElement(L.a,{label:"BACK",primary:!0,onClick:this.gotoVariablePage.bind(this),style:{marginRight:5}}),s.a.createElement(I.a,{label:"Submit",primary:!0,onClick:this.saveVariable})],t=v.filter(this.props.variable.variable,function(e){return"user"==e.variable_type}),r=v.filter(this.props.variable.variable,function(e){return"system"===e.variable_type});return s.a.createElement("div",{className:"app-body",id:"view",style:{marginTop:10}},s.a.createElement("div",{className:"col-xs-12 col-sm-12",style:{float:"right"}},s.a.createElement(D.a,{className:"add-variable-dialog",actionsContainerClassName:"action-buttons",title:this.state.dialogTitle,actions:a,modal:!1,open:this.state.openDialog,onRequestClose:this.gotoVariablePage.bind(this),autoScrollBodyContent:!0},s.a.createElement("div",{id:"add-variable-form"},s.a.createElement("form",{className:"form-inline"},s.a.createElement("div",{className:"form-group",style:$.formInput},s.a.createElement(N.a,{className:"variable-code",ref:"value",floatingLabelText:this.state.floatingLabelCode,floatingLabelFixed:!0,hintText:this.state.hintCode,fullWidth:!0,errorText:this.state.varCodeError,value:this.state.variableCode,onChange:function(a){e.setState({variableCode:a.target.value})}})),s.a.createElement("div",{className:"form-group",style:$.formInput},s.a.createElement(P.RadioButtonGroup,{name:"shipSpeed",defaultSelected:"richEditor",onChange:function(a){e.changeEditor(a)}},s.a.createElement(P.RadioButton,{className:"headerFooter",value:"textArea",label:"Add header/footer",style:$.radioButton}),s.a.createElement(P.RadioButton,{className:"otherThanHeaderFooter",value:"richEditor",label:"Otherthen header/footer",style:$.radioButton}))),s.a.createElement("div",{className:"form-group",style:$.formInput},s.a.createElement("label",{style:{fontSize:"13px",color:"#BFBFBF"}},"Enter Variable Value"),s.a.createElement("div",{className:this.state.editor},s.a.createElement(K.a,{style:$.editorStyle,value:this.state.variableValue,onChange:this.onChange})),s.a.createElement("div",{className:this.state.textArea},s.a.createElement("textarea",{style:{width:"100%"},placeholder:"Write html code for header/footer",className:"form-control",rows:"4",ref:"client_address",onChange:function(a){e.setState({variableValue_forTextArea:a.target.value})},value:this.state.variableValue_forTextArea})))))),s.a.createElement("div",{className:"row",style:{margin:"0px 4px 0px"}},s.a.createElement("div",{className:"col-xs-12"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-12",style:{paddingTop:"16px",paddingRight:"0px"}},s.a.createElement("button",{className:"md-btn md-raised m-b-sm indigo",id:"add-new-variable",onClick:this.openCreateVariable},"Add New Variable")),s.a.createElement("div",{className:this.state.paper,style:{marginTop:"8%"}},s.a.createElement("div",{className:"table-responsive table-condensed"},s.a.createElement(H.a,{zDepth:1,style:{marginBottom:"10px"}},s.a.createElement(q.Table,{className:"variable-list",fixedHeader:!0,fixedFooter:!0,onRowSelection:function(a){1==a.length&&e.editVariable(t[a])}},s.a.createElement(q.TableHeader,{adjustForCheckbox:!1,displaySelectAll:!1},s.a.createElement(q.TableRow,null,s.a.createElement(q.TableRowColumn,{colSpan:"3"},s.a.createElement("h4",{style:{float:"left",marginLeft:"-5%",paddingTop:"1%",paddingBottom:"1%",paddingLeft:"5%",paddingRight:"3%",fontWeight:"bold"}},"User Variable(s)"))),s.a.createElement(q.TableRow,null,s.a.createElement(q.TableRowColumn,{colSpan:1,style:{fontWeight:"bold"}},"Variable code"),s.a.createElement(q.TableRowColumn,{colSpan:1,style:{fontWeight:"bold"}},"Variable value"),s.a.createElement(q.TableRowColumn,{colSpan:1,style:{fontWeight:"bold",textAlign:"center"}},"Delete"))),s.a.createElement(q.TableBody,{className:"variable-table-body",displayRowCheckbox:!1},v.map(t,function(a,t){return s.a.createElement(q.TableRow,{id:a.name.slice(1)+"_tr",key:a.id,style:{cursor:"pointer"}},s.a.createElement(q.TableRowColumn,{colSpan:1,id:"".concat(a.name.slice(1),"_td'")},a.name),s.a.createElement(q.TableRowColumn,{colSpan:1},s.a.createElement("div",{className:"p-l",dangerouslySetInnerHTML:{__html:a.value}})),s.a.createElement(q.TableRowColumn,{colSpan:1,style:{textAlign:"center"}},s.a.createElement(z.a,{id:a.name.slice(1)+"_button",tooltip:"Delete Variable",tooltipPosition:"top-right",iconStyle:{color:"#B71C1C"},children:s.a.createElement(J.a,{color:"#B71C1C"}),onClick:function(t){t.stopPropagation(),e.deleteVariable(a)}})))})))),s.a.createElement(H.a,{zDepth:1},s.a.createElement(q.Table,{fixedHeader:!0,fixedFooter:!0},s.a.createElement(q.TableHeader,{adjustForCheckbox:!1,displaySelectAll:!1},s.a.createElement(q.TableRow,null,s.a.createElement(q.TableRowColumn,null,s.a.createElement("h4",{style:{float:"left",marginLeft:"-5%",paddingTop:"1%",paddingBottom:"1%",paddingLeft:"5%",paddingRight:"3%",fontWeight:"bold"}},"System Variable(s)"))),s.a.createElement(q.TableRow,null,s.a.createElement(q.TableRowColumn,{colSpan:1,style:{fontWeight:"bold"}},"Variable code"))),s.a.createElement(q.TableBody,{displayRowCheckbox:!1},v.map(r,function(e){return s.a.createElement(q.TableRow,{key:e.id,style:{cursor:"pointer"}},s.a.createElement(q.TableRowColumn,{colSpan:1},e.name))})))))))))))}}]),a}(s.a.Component),X=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(n.a)(this,Object(o.a)(a).call(this,e))).props.onIsAlreadyLogin(),t}return Object(i.a)(a,e),Object(l.a)(a,[{key:"componentWillMount",value:function(){this.props.onFetchVariables()}},{key:"componentWillReceiveProps",value:function(e){var a=Object(m.e)(this.props.location.pathname,e.loggedUser);a.status&&this.props.history.push(a.redirectTo)}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(u.a,this.props),s.a.createElement("div",{id:"content",className:"app-content box-shadow-z0",role:"main"},s.a.createElement(p.a,{pageTitle:"Template Variable",showLoading:this.props.frontend.show_loading}),s.a.createElement(Q,this.props)))}}]),a}(s.a.Component);var Y=Object(d.b)(function(e){return{frontend:e.frontend.toJS(),loggedUser:e.logged_user.userLogin,variable:e.template.toJS()}},function(e){return{onIsAlreadyLogin:function(){return e(h.isAlreadyLogin())},onFetchVariables:function(){return e(x())},onSaveVariable:function(a,t){return e(O(a,t))},onDeleteVariable:function(a){return e(j(a))}}})(X),Z=Object(b.a)(Y);a.default=Z}}]);
//# sourceMappingURL=34.8a52dc9e.chunk.js.map